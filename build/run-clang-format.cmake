if(NOT DEFINED CLANG_FORMAT) message(FATAL_ERROR "CLANG_FORMAT not set") endif()
if(NOT DEFINED FILES)        message(FATAL_ERROR "FILES not set")        endif()
string(REPLACE "|" ";" file_list "${FILES}")
list(LENGTH file_list nfiles)
message(STATUS "clang-format: formatting ${nfiles} files")
foreach(f IN LISTS file_list)
  if(EXISTS "${f}")
    execute_process(COMMAND "${CLANG_FORMAT}" --style=file -i "${f}")
  else()
    message(WARNING "clang-format: missing file '${f}'")
  endif()
endforeach()
